# Ethereumæœ¬åœ°ç½‘ç»œé›†ç¾¤

é€šè¿‡æœ¬æ–‡æ‰€è¿°æ–¹æ³•å’Œé¡¹ç›®ä¸­çš„è„šæœ¬ï¼Œå¯ä»¥å¿«é€Ÿæ­å»ºæœ¬åœ°ç½‘ç»œé›†ç¾¤ï¼Œè¿›è¡Œæµ‹è¯•å’ŒéªŒè¯ã€‚

ä»“åº“ä¸­åŒ…å«çš„å·¥å…·æœ‰ï¼š

* åŒå•èŠ‚ç‚¹çš„åˆå§‹åŒ–`genesis.json`é…ç½®æ–‡ä»¶ï¼Œä¸ºå¯¹åº”çš„äº”ä¸ªæµ‹è¯•è´¦æˆ·æä¾›åˆå§‹èµ„é‡‘ï¼ˆä»¥å¤ªå¸ï¼‰ï¼Œæ–¹ä¾¿å¼€å‘æµ‹è¯•ã€‚

****

## å‡†å¤‡

1. åœ¨æœ¬åœ°å®‰è£…å¥½[go-ethereum](https://github.com/ethereum/go-ethereum)å¯ä»¥æ‰§è¡Œ`geth`å‘½ä»¤ã€‚å¦‚æœæ“ä½œç³»ç»Ÿæ˜¯ubuntu, å®‰è£…å®˜æ–¹çš„ethereumå®‰è£…åŒ…å³å¯ã€‚

   ```shell
   Ubuntu 14.04ç¯å¢ƒï¼Œå…¶ä»–å‡†å¤‡

   æ›´æ”¹Ubuntuçš„aptæºä¸ºé˜¿é‡Œçš„
   å‚è€ƒï¼š https://www.cnblogs.com/lyon2014/p/4715379.html
   æ›´æ”¹/etc/apt/sources.list
   root@geth-node01:~# cat /etc/apt/sources.list
   deb http://mirrors.aliyun.com/ubuntu/ trusty main multiverse restricted universe
   deb http://mirrors.aliyun.com/ubuntu/ trusty-backports main multiverse restricted universe
   deb http://mirrors.aliyun.com/ubuntu/ trusty-proposed main multiverse restricted universe
   deb http://mirrors.aliyun.com/ubuntu/ trusty-security main multiverse restricted universe
   deb http://mirrors.aliyun.com/ubuntu/ trusty-updates main multiverse restricted universe
   deb-src http://mirrors.aliyun.com/ubuntu/ trusty main multiverse restricted universe
   deb-src http://mirrors.aliyun.com/ubuntu/ trusty-backports main multiverse restricted universe
   deb-src http://mirrors.aliyun.com/ubuntu/ trusty-proposed main multiverse restricted universe
   deb-src http://mirrors.aliyun.com/ubuntu/ trusty-security main multiverse restricted universe
   deb-src http://mirrors.aliyun.com/ubuntu/ trusty-updates main multiverse restricted universe

   äº‘ç¯å¢ƒçš„VMï¼Œæ ¹æ®æƒ…å†µéœ€è¦æ‰‹å·¥æ›´æ”¹/etc/resolve.confï¼Œå¯ç”¨å…¬ç½‘åŸŸåæœåŠ¡å™¨8.8.8.8
   root@geth-node01:~# cat /etc/resolv.conf 
   # Dynamic resolv.conf(5) file for glibc resolver(3) generated by resolvconf(8)
   #     DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN
   nameserver 8.8.8.8

   ç„¶åæ‰§è¡Œ
   sudo apt-get update
   sudo apt-get install software-properties-common
   sudo add-apt-repository -y ppa:ethereum/ethereum
   sudo apt-get update
   sudo apt-get install ethereum solc
   ```

2. å®‰è£…gitå·¥å…·`sudo apt-get install git`ï¼Œå°†æœ¬ä»“åº“é€šè¿‡`git clone`å‘½ä»¤ä¸‹è½½åˆ°æœ¬åœ°ã€‚

3. å®‰è£…[expect](http://expect.sourceforge.net/)ï¼Œå·¥å…·è„šæœ¬ç”¨å®ƒæ¥è‡ªåŠ¨åŒ–ä¸€äº›è¿‡ç¨‹ã€‚ä¾‹å¦‚åœ¨ubuntuä¸Š: `sudo apt-get install expect`

   **è¯´æ˜ï¼šåœ¨ç¬¬äºŒä¸ªèŠ‚ç‚¹å¼€å§‹å°è¯•ä½¿ç”¨æ™®é€šç”¨æˆ·å¯åŠ¨gethæœåŠ¡ã€‚**

## éªŒè¯æµ‹è¯•ï¼ˆä¸€ï¼‰ï¼š æ­£å¸¸å¯åŠ¨å¤šä¸ªèŠ‚ç‚¹ï¼Œç»„æˆé›†ç¾¤

1. éªŒè¯æ€è·¯ï¼š

   - ä½¿ç”¨`genesis.json`åˆå§‹åŒ–bootnodeï¼Œç„¶ååˆ›å»ºbootnodeçš„èŠ‚ç‚¹Keyï¼Œå¹¶å¯åŠ¨ï¼›
   - åˆ†åˆ«ä½¿ç”¨`genesis.json`åˆå§‹åŒ–å„ä¸ªèŠ‚ç‚¹ï¼Œç„¶åä½¿ç”¨bootnodeçš„è¿æ¥ä¸²å¯åŠ¨å„ä¸ªèŠ‚ç‚¹ï¼›
   - å„ä¸ªèŠ‚ç‚¹å¯ä»¥åœ¨åŒä¸€ä¸ªæœºå™¨ï¼ˆéœ€è¦æŒ‡å®šä¸åŒçš„ç½‘ç»œï¼‰ï¼Œä¹Ÿå¯ä»¥åœ¨ä¸åŒçš„æœºå™¨ã€‚
   - å„ä¸ªèŠ‚ç‚¹æ“ä½œæ—¶ä½¿ç”¨ç§æœ‰ç½‘ç»œIDï¼Œè¿™é‡Œæµ‹è¯•ä½¿ç”¨ã€20180412ã€‘ã€‚
   - æ‰€æœ‰æ¶‰åŠç”¨æˆ·Keyçš„å¯†ç ï¼Œç»Ÿä¸€ä½¿ç”¨ã€123456ã€‘ç®€åŒ–æ“ä½œã€‚

2. è¿›å…¥æœ¬ä»“åº“ç›®å½•: `cd ethereum-bootstrap/3.LocalNetworkCluster`

3. åˆå§‹åŒ–å¹¶å¯åŠ¨bootnode:

   ```shell
   # åˆ›å»ºç›®å½•å¹¶è¿›å…¥åˆ°bootnodeç›®å½•
   ubuntu@geth-node01:~/ethereum-bootstrap/3.LocalNetworkCluster$ mkdir bootnode
   ubuntu@geth-node01:~/ethereum-bootstrap/3.LocalNetworkCluster$ cd bootnode/
   # ç”Ÿæˆbootnodeçš„èŠ‚ç‚¹Key
   ubuntu@geth-node01:~/ethereum-bootstrap/3.LocalNetworkCluster/bootnode$ bootnode --genkey=boot.key
   ubuntu@geth-node01:~/ethereum-bootstrap/3.LocalNetworkCluster/bootnode$ ls -ltr
   total 8
   -rw------- 1 ubuntu ubuntu   64 Apr 13 10:09 boot.key
   # ä¸Šé¢çš„boot.keyå°±æ˜¯ç”Ÿæˆçš„bootnodeçš„èŠ‚ç‚¹Key

   # ä¸‹é¢ä½¿ç”¨genesis.jsonåˆå§‹åŒ–bootnodeçš„chaincodeä¿¡æ¯
   ubuntu@geth-node01:~/ethereum-bootstrap/3.LocalNetworkCluster/bootnode$ geth --datadir data --networkid 20180412  init ../genesis.json 
   INFO [04-13|10:09:12] Maximum peer count                       ETH=25 LES=0 total=25
   INFO [04-13|10:09:12] Allocated cache and file handles         database=/home/ubuntu/ethereum-bootstrap/3.LocalNetworkCluster/bootnode/data/geth/chaindata cache=16 handles=16
   INFO [04-13|10:09:12] Writing custom genesis block 
   INFO [04-13|10:09:12] Persisted trie from memory database      nodes=7 size=1.31kB time=73.599Âµs gcnodes=0 gcsize=0.00B gctime=0s livenodes=1 livesize=0.00B
   INFO [04-13|10:09:12] Successfully wrote genesis state         database=chaindata                                                                          hash=194258â€¦f0efa3
   INFO [04-13|10:09:12] Allocated cache and file handles         database=/home/ubuntu/ethereum-bootstrap/3.LocalNetworkCluster/bootnode/data/geth/lightchaindata cache=16 handles=16
   INFO [04-13|10:09:12] Writing custom genesis block 
   INFO [04-13|10:09:12] Persisted trie from memory database      nodes=7 size=1.31kB time=478.772Âµs gcnodes=0 gcsize=0.00B gctime=0s livenodes=1 livesize=0.00B
   INFO [04-13|10:09:12] Successfully wrote genesis state         database=lightchaindata                                                                          hash=194258â€¦f0efa3
   ubuntu@geth-node01:~/ethereum-bootstrap/3.LocalNetworkCluster/bootnode$ ls -ltr
   total 8
   -rw------- 1 ubuntu ubuntu   64 Apr 13 10:09 boot.key
   drwx------ 4 ubuntu ubuntu 4096 Apr 13 10:09 data
   # ç”Ÿæˆäº†dataç›®å½•ï¼Œå­˜å‚¨äº†chaincodeçš„æ•°æ®

   # å¯åŠ¨bootnodeï¼Œè·å–bootnodeçš„æ¥å…¥åœ°å€ä¸²
   ubuntu@geth-node01:~/ethereum-bootstrap/3.LocalNetworkCluster/bootnode$ bootnode --nodekey=boot.key
   INFO [04-13|10:09:18] UDP listener up                          self=enode://322de50135b1542f17585e73aea7ffe9585e9d988cecdff40732842113e5cdb9ae249ca3b12fe7658101632bfc5e19493acf941d9a52a2a9f16627318f01e76d@[::]:30301
   # ä¸Šé¢æ¥å…¥åœ°å€ä¸²ä¸­[::]éœ€è¦æ ¹æ®éœ€è¦æ›¿æ¢æˆæœ¬åœ°çš„IPåœ°å€ï¼Œä¾›å…¶ä»–èŠ‚ç‚¹æ¥å…¥æ—¶å€™ä½¿ç”¨ï¼Œä¾‹å¦‚ï¼š
   # enode://322de50135b1542f17585e73aea7ffe9585e9d988cecdff40732842113e5cdb9ae249ca3b12fe7658101632bfc5e19493acf941d9a52a2a9f16627318f01e76d@10.20.1.13:30301
   # è¿™ä¸ªåœ°å€è·Ÿbootnodeçš„Keyæœ‰å…³ï¼ŒKeyä¸å˜ï¼Œåœ°å€ä¸å˜
   # æ³¨æ„ï¼š é‡å¤æµ‹è¯•çš„æ—¶å€™ï¼Œå¦‚æœè¦é‡ç½®bootnodeï¼Œéœ€è¦åˆ é™¤boot.keyå’Œdataç›®å½•ã€‚
   ```

4. æœ¬æœºå¯åŠ¨ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼š

   ```shell
   # å¯åŠ¨èŠ‚ç‚¹ä¸»è¦å‘½ä»¤ï¼š
   # 1ã€åˆå§‹åŒ–
   geth --datadir data --networkid 20180412 init ../genesis.json
   # 2ã€å¯åŠ¨èŠ‚ç‚¹
   geth --datadir ./data --networkid 20180412 --bootnodes=enode://322de50135b1542f17585e73aea7ffe9585e9d988cecdff40732842113e5cdb9ae249ca3b12fe7658101632bfc5e19493acf941d9a52a2a9f16627318f01e76d@10.20.1.13:30301 --port 30303 console
   ```

   è¯¦ç»†å†…å®¹ï¼š

   ```shell
   # æ‰“å¼€ä¸€ä¸ªæ–°çš„ç»ˆç«¯
   ubuntu@geth-node01:~/ethereum-bootstrap/3.LocalNetworkCluster$ mkdir node1
   ubuntu@geth-node01:~/ethereum-bootstrap/3.LocalNetworkCluster$ cd node1/
   ubuntu@geth-node01:~/ethereum-bootstrap/3.LocalNetworkCluster/node1$ ls
   ubuntu@geth-node01:~/ethereum-bootstrap/3.LocalNetworkCluster/node1$ ls -ltr
   total 0

   # ä¸‹é¢ä½¿ç”¨genesis.jsonåˆå§‹åŒ–node1çš„chaincodeä¿¡æ¯
   ubuntu@geth-node01:~/ethereum-bootstrap/3.LocalNetworkCluster/node1$ geth --datadir data --networkid 20180412 init ../genesis.json 
   INFO [04-13|10:29:22] Maximum peer count                       ETH=25 LES=0 total=25
   INFO [04-13|10:29:22] Allocated cache and file handles         database=/home/ubuntu/ethereum-bootstrap/3.LocalNetworkCluster/node1/data/geth/chaindata cache=16 handles=16
   INFO [04-13|10:29:22] Writing custom genesis block 
   INFO [04-13|10:29:22] Persisted trie from memory database      nodes=7 size=1.31kB time=98.552Âµs gcnodes=0 gcsize=0.00B gctime=0s livenodes=1 livesize=0.00B
   INFO [04-13|10:29:22] Successfully wrote genesis state         database=chaindata                                                                       hash=194258â€¦f0efa3
   INFO [04-13|10:29:22] Allocated cache and file handles         database=/home/ubuntu/ethereum-bootstrap/3.LocalNetworkCluster/node1/data/geth/lightchaindata cache=16 handles=16
   INFO [04-13|10:29:22] Writing custom genesis block 
   INFO [04-13|10:29:22] Persisted trie from memory database      nodes=7 size=1.31kB time=451.459Âµs gcnodes=0 gcsize=0.00B gctime=0s livenodes=1 livesize=0.00B
   INFO [04-13|10:29:22] Successfully wrote genesis state         database=lightchaindata                                                                       hash=194258â€¦f0efa3 
   # æ³¨æ„ï¼š ä¸Šé¢åˆå§‹åŒ–ç”Ÿæˆçš„[194258â€¦f0efa3]ä¸bootnodeæ˜¯ä¸€è‡´çš„ï¼Œå› æ­¤åªè¦ä¸€ä¸ªèŠ‚ç‚¹åˆå§‹åŒ–ä¸€æ¬¡ï¼Œå…¶ä»–èŠ‚ç‚¹å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ä¸ªæ•°æ®ä½œä¸ºèµ·å§‹æ•°æ®åŒ…è€Œä¸ç”¨åˆå§‹åŒ–æ“ä½œ
   ubuntu@geth-node01:~/ethereum-bootstrap/3.LocalNetworkCluster/node1$ ls -ltr
   total 4
   drwx------ 4 ubuntu ubuntu 4096 Apr 13 10:35 data

   # å¯åŠ¨èŠ‚ç‚¹ï¼Œå‚æ•°ä¸»è¦ä¸ºç½‘ç»œIDä¸bootnodeçš„ä¸€è‡´ï¼Œbootnodesçš„å†…å®¹æŒ‡å‘bootnodeèŠ‚ç‚¹çš„åœ°å€ä¸²ï¼ŒæŒ‡å¯¼ç«¯å£
   ubuntu@geth-node01:~/ethereum-bootstrap/3.LocalNetworkCluster/node1$ geth --datadir ./data --networkid 20180412 --bootnodes=enode://322de50135b1542f17585e73aea7ffe9585e9d988cecdff40732842113e5cdb9ae249ca3b12fe7658101632bfc5e19493acf941d9a52a2a9f16627318f01e76d@10.20.1.13:30301 --port 30303 console
   INFO [04-13|10:34:24] Maximum peer count                       ETH=25 LES=0 total=25
   INFO [04-13|10:34:24] Starting peer-to-peer node               instance=Geth/v1.8.3-stable-329ac18e/linux-amd64/go1.10
   INFO [04-13|10:34:24] Allocated cache and file handles         database=/home/ubuntu/ethereum-bootstrap/3.LocalNetworkCluster/node1/data/geth/chaindata cache=768 handles=512
   WARN [04-13|10:34:24] Upgrading database to use lookup entries 
   INFO [04-13|10:34:24] Initialised chain configuration          config="{ChainID: 15 Homestead: 0 DAO: <nil> DAOSupport: false EIP150: <nil> EIP155: 0 EIP158: 0 Byzantium: <nil> Constantinople: <nil> Engine: unknown}"
   INFO [04-13|10:34:24] Disk storage enabled for ethash caches   dir=/home/ubuntu/ethereum-bootstrap/3.LocalNetworkCluster/node1/data/geth/ethash count=3
   INFO [04-13|10:34:24] Disk storage enabled for ethash DAGs     dir=/home/ubuntu/.ethash                                                         count=2
   INFO [04-13|10:34:24] Initialising Ethereum protocol           versions="[63 62]" network=20180412
   INFO [04-13|10:34:24] Loaded most recent local header          number=0 hash=194258â€¦f0efa3 td=131072
   INFO [04-13|10:34:24] Loaded most recent local full block      number=0 hash=194258â€¦f0efa3 td=131072
   INFO [04-13|10:34:24] Loaded most recent local fast block      number=0 hash=194258â€¦f0efa3 td=131072
   INFO [04-13|10:34:24] Regenerated local transaction journal    transactions=0 accounts=0
   INFO [04-13|10:34:24] Starting P2P networking 
   INFO [04-13|10:34:24] Database deduplication successful        deduped=0
   INFO [04-13|10:34:26] UDP listener up                          self=enode://8a3d7c1b505f4a1ad1034de06c3e118a9067730f2b771aaaa16d38c77b75ae795beca3b631708aa5f7675f3707476173cc435c231bd89eee02f846690091bc5e@[::]:30303
   INFO [04-13|10:34:26] RLPx listener up                         self=enode://8a3d7c1b505f4a1ad1034de06c3e118a9067730f2b771aaaa16d38c77b75ae795beca3b631708aa5f7675f3707476173cc435c231bd89eee02f846690091bc5e@[::]:30303
   INFO [04-13|10:34:26] IPC endpoint opened                      url=/home/ubuntu/ethereum-bootstrap/3.LocalNetworkCluster/node1/data/geth.ipc
   Welcome to the Geth JavaScript console!

   instance: Geth/v1.8.3-stable-329ac18e/linux-amd64/go1.10
    modules: admin:1.0 debug:1.0 eth:1.0 miner:1.0 net:1.0 personal:1.0 rpc:1.0 txpool:1.0 web3:1.0

   > 
   ```

5. æœ¬æœºå¯åŠ¨ç¬¬äºŒä¸ªèŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹ç›®å½•æ›´æ”¹ä¸ºnode2ï¼ŒèŠ‚ç‚¹å¯åŠ¨ç«¯å£æ›´æ”¹ä¸º30323ï¼Œå¯åŠ¨è¾“å‡ºç•¥ã€‚

6. è¿™ä¸ªæ—¶å€™åœ¨ç¬¬ä¸€ä¸ªèŠ‚ç‚¹æˆ–ç¬¬äºŒä¸ªèŠ‚ç‚¹ä¸Šæ‰§è¡Œï¼š

   ```
   > net.peerCount
   1
   > net.listening
   true
   > admin.peers
   [{
       caps: ["eth/63"],
       id: "8a3d7c1b505f4a1ad1034de06c3e118a9067730f2b771aaaa16d38c77b75ae795beca3b631708aa5f7675f3707476173cc435c231bd89eee02f846690091bc5e",
       name: "Geth/v1.8.3-stable-329ac18e/linux-amd64/go1.10",
       network: {
         inbound: false,
         localAddress: "10.20.1.13:55921",
         remoteAddress: "10.20.1.13:30303",
         static: false,
         trusted: false
       },
       protocols: {
         eth: {
           difficulty: 131072,
           head: "0x19425866b7d3298a15ad79accf302ba9d21859174e7ae99ce552e05f13f0efa3",
           version: 63
         }
       }
   }]
   ```

   å¯ä»¥çœ‹åˆ°ç›¸å…³èŠ‚ç‚¹çš„IDä¿¡æ¯å·²ç»äº’ç›¸æ¥å…¥äº†ã€‚

7. æœ¬åœ°ç½‘ç»œä¸­å…¶ä»–æœåŠ¡å™¨ä¸Šå¯åŠ¨ç¬¬ä¸‰ä¸ªèŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹ç›®å½•ä¸ºnode3ï¼ŒèŠ‚ç‚¹å¯åŠ¨ç«¯å£æ›´æ”¹ä¸º30333ï¼Œå¯åŠ¨è¾“å‡ºç•¥ï¼›å¯åŠ¨æˆåŠŸåï¼Œåœ¨å„ä¸ªèŠ‚ç‚¹æ‰§è¡Œnet.peerCountã€net.listeningã€admin.peersæŸ¥çœ‹èŠ‚ç‚¹çš„æ¥å…¥äº’è”æ­£å¸¸ã€‚
   **æ›¾ç»é‡åˆ°è¿‡èŠ‚ç‚¹å¯åŠ¨åæ²¡æœ‰åŠ å…¥æˆåŠŸï¼ŒæŠŠbootnodeé‡æ–°å¯åŠ¨åï¼Œç„¶åé‡æ–°å¯åŠ¨node3ï¼Œç„¶åæ­£å¸¸æ¥å…¥äº†ã€‚**

8. è´¦å·åŸºæœ¬æ“ä½œï¼š

   ```
   # æŸ¥çœ‹ç®—åŠ›
   > eth.hashrate
   0
   # æŸ¥çœ‹èŠ‚ç‚¹Blockåºå·
   > eth.blockNumber
   0
   # åˆ›å»ºè´¦å·
   > personal.newAccount('123456')
   "0x798e5632b04b344df4ae6a7d26a8138aa1ab16cf"
   # æŸ¥è¯¢è´¦å·ä½™é¢
   > web3.eth.getBalance(web3.eth.accounts[0])
   0
   > web3.eth.getBalance("0x798e5632b04b344df4ae6a7d26a8138aa1ab16cf")
   0
   > web3.fromWei(eth.getBalance(eth.accounts[0]), "ether")
   0
   > eth.accounts
   ["0x798e5632b04b344df4ae6a7d26a8138aa1ab16cf"]
   ```

9. å¼€å¯æŒ–çŸ¿ï¼š

   ```
   > miner.start(1)
   INFO [04-13|11:05:54] Updated mining threads                   threads=1
   INFO [04-13|11:05:54] Transaction pool price threshold updated price=18000000000
   INFO [04-13|11:05:54] Etherbase automatically configured       address=0x798e5632B04b344df4Ae6A7d26a8138aa1Ab16cF
   null
   > INFO [04-13|11:05:54] Starting mining operation 
   INFO [04-13|11:05:54] Commit new mining work                   number=1 txs=0 uncles=0 elapsed=474.118Âµs
   INFO [04-13|11:05:58] Generating DAG in progress               epoch=0 percentage=0 elapsed=2.047s
   INFO [04-13|11:06:00] Generating DAG in progress               epoch=0 percentage=1 elapsed=4.036s
   INFO [04-13|11:06:02] Generating DAG in progress               epoch=0 percentage=2 elapsed=6.051s
   ......
   INFO [04-13|11:09:23] Generating DAG in progress               epoch=0 percentage=99 elapsed=3m27.293s
   INFO [04-13|11:09:23] Generated ethash verification cache      epoch=0 elapsed=3m27.295s
   INFO [04-13|11:09:24] Successfully sealed new block            number=1 hash=4c4e5eâ€¦cc7307
   INFO [04-13|11:09:24] ğŸ”¨ mined potential block                  number=1 hash=4c4e5eâ€¦cc7307
   INFO [04-13|11:09:24] Commit new mining work                   number=2 txs=0 uncles=0 elapsed=162.856Âµs
   INFO [04-13|11:09:24] Successfully sealed new block            number=2 hash=0e7f6câ€¦b9efec
   INFO [04-13|11:09:24] ğŸ”¨ mined potential block                  number=2 hash=0e7f6câ€¦b9efec
   INFO [04-13|11:09:24] Commit new mining work                   number=3 txs=0 uncles=0 elapsed=171.726Âµs
   ......
   > miner.stop()
   true
   ```

   åœ¨å…¶ä»–èŠ‚ç‚¹ä¸Šèƒ½å¤Ÿçœ‹åˆ°Blockçš„åŒæ­¥ä¿¡æ¯ï¼š

   ```
   > INFO [04-13|11:09:24] Block synchronisation started 
   INFO [04-13|11:09:24] Imported new state entries               count=2 elapsed=57.819Âµs processed=2 pending=0 retry=0 duplicate=0 unexpected=0
   WARN [04-13|11:09:26] Discarded bad propagated block           number=1 hash=4c4e5eâ€¦cc7307
   INFO [04-13|11:09:26] Imported new block headers               count=2 elapsed=1.405s   number=2 hash=0e7f6câ€¦b9efec ignored=0
   INFO [04-13|11:09:26] Imported new chain segment               blocks=2 txs=0 mgas=0.000 elapsed=681.457Âµs mgasps=0.000 number=2 hash=0e7f6câ€¦b9efec cache=768.00B
   INFO [04-13|11:09:26] Fast sync complete, auto disabling 
   INFO [04-13|11:09:30] Imported new chain segment               blocks=1 txs=0 mgas=0.000 elapsed=7.287ms   mgasps=0.000 number=3 hash=0ae39aâ€¦2b4fa5 cache=1.13kB
   INFO [04-13|11:09:32] Imported new chain segment               blocks=1 txs=0 mgas=0.000 elapsed=4.736ms   mgasps=0.000 number=4 hash=4b348câ€¦3115d7 cache=1.49kB
   INFO [04-13|11:09:44] Imported new chain segment               blocks=1 txs=0 mgas=0.000 elapsed=4.771ms   mgasps=0.000 number=5 hash=4657ccâ€¦4848a9 cache=1.84kB
   INFO [04-13|11:09:45] Imported new chain segment               blocks=1 txs=0 mgas=0.000 elapsed=5.726ms   mgasps=0.000 number=6 hash=bda46bâ€¦2f1a29 cache=2.20kB
   ```

   ç„¶åå„ä¸ªèŠ‚ç‚¹ä¸ŠæŸ¥çœ‹eth.blockNumberï¼š

   ```
   > eth.blockNumber
   6
   ```

   åœ¨æŒ–çŸ¿çš„èŠ‚ç‚¹ä¸ŠæŸ¥çœ‹è´¦å·çš„é‡‘é¢ï¼š

   ```shell
   > web3.fromWei(eth.getBalance(eth.accounts[0]), "ether")
   30
   # æŒ–åˆ°äº†30ä¸ªä»¥å¤ªå¸ï¼Œå“ˆå“ˆå“ˆ
   ```

   å…¶ä»–å„ä¸ªèŠ‚ç‚¹ä¹Ÿåˆ›å»ºè´¦å·ï¼Œéƒ½å¯åŠ¨æŒ–çŸ¿ï¼Œçœ‹çœ‹ğŸ”¨ å¼€æŠ¢~~~

10. è½¬è´¦ï¼šåœ¨ä»»æ„èŠ‚ç‚¹ä¸Šæ‰§è¡Œè½¬è´¦æ“ä½œï¼Œç„¶ååœ¨ä»»æ„èŠ‚ç‚¹å¯åŠ¨æŒ–çŸ¿ï¼Œå¯ä»¥å®Œæˆè½¬è´¦äº¤æ˜“çš„æœ€ç»ˆè®°è´¦ã€‚

  ```shell
  > personal.listAccounts
  ["0xf4f361b18677a2ca651445e54cadd6001bddecfd"]
  > var tx = {from: "0xf4f361b18677a2ca651445e54cadd6001bddecfd", to: "0x22311a0ef19096a6f2a63c214cf02a726b5a3e75", value: web3.toWei(88, "ether")}
  undefined
  > personal.sendTransaction(tx, "123456")
  INFO [04-13|11:26:22] Submitted transaction                    fullhash=0x838fec578b7a32f2012808368d3910467b494ccd08cf4d3f006e70912d182a14 recipient=0x22311a0EF19096A6f2a63C214CF02A726B5A3e75
  "0x838fec578b7a32f2012808368d3910467b494ccd08cf4d3f006e70912d182a14"

  > txpool.content
  {
    pending: {
      0xf4f361B18677A2CA651445e54CaDD6001bdDEcFd: {
        0: {
          blockHash: "0x0000000000000000000000000000000000000000000000000000000000000000",
          blockNumber: null,
          from: "0xf4f361b18677a2ca651445e54cadd6001bddecfd",
          gas: "0x15f90",
          gasPrice: "0x430e23400",
          hash: "0x838fec578b7a32f2012808368d3910467b494ccd08cf4d3f006e70912d182a14",
          input: "0x",
          nonce: "0x0",
          r: "0xe3bae4485860bb271d8bb9de14ff0c8d3a1a5379943ea72052a6f706a2865091",
          s: "0x6498221b8bb4d6f53de36fbb6eb9b79e16bf898c886cd48debcba931b45cacfe",
          to: "0x22311a0ef19096a6f2a63c214cf02a726b5a3e75",
          transactionIndex: "0x0",
          v: "0x42",
          value: "0x4c53ecdc18a600000"
        }
      }
    },
    queued: {}
  }
  > txpool.inspect
  {
    pending: {
      0xf4f361B18677A2CA651445e54CaDD6001bdDEcFd: {
        0: "0x22311a0EF19096A6f2a63C214CF02A726B5A3e75: 88000000000000000000 wei + 90000 gas Ã— 18000000000 wei"
      }
    },
    queued: {}
  }
  > txpool.status
  {
    pending: 1,
    queued: 0
  }
  > txpool.content
     {
       pending: {},
       queued: {}

     }
  INFO [04-13|11:29:56] Imported new chain segment               blocks=1 txs=0 mgas=0.000 elapsed=3.870ms   mgasps=0.000 number=75 hash=2ee2feâ€¦7ac89b cache=37.66kB
  > txpool.status
     {
       pending: 0,
       queued: 0
     }
     
     
  # ç»“æœï¼Œè½¬å‡ºè´¦æˆ·
  > web3.fromWei(eth.getBalance(eth.accounts[0]), "ether")
     50.437122
  # ä¹‹å‰ä½™é¢138.4375ï¼Œè½¬èµ°88ï¼Œæ‰‹ç»­è´¹0.00162(88000000000000000000 wei + 90000 gas Ã— 18000000000 wei)ï¼Œå®é™…ä¸Šè¿™ä¸ªåœ°æ–¹çš„æ‰‹ç»­è´¹åªèŠ±è´¹äº†0.000378(åŸä½™é¢-æ–°ä½™é¢-è½¬èµ°é‡‘é¢)ï¼Œéœ€è¦è¿›ä¸€æ­¥è°ƒæŸ¥

  # è½¬å…¥è´¦æˆ·
  > web3.fromWei(eth.getBalance(eth.accounts[0]), "ether")
     161.90625
  # ä¹‹å‰ä½™é¢73.90625ï¼Œæ–°å¢88
  ```




## éªŒè¯æµ‹è¯•ï¼ˆäºŒï¼‰ï¼š æ‹·è´åˆå§‹çš„bootnodeçš„dataç›®å½•è¿›è¡Œé›†ç¾¤æ„å»º

1. éªŒè¯æ€è·¯ï¼š

   - ä¸‰ä¸ªèŠ‚ç‚¹è¿è¡Œæ­£å¸¸çš„çŠ¶æ€ï¼Œåœæ‰å…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ‹·è´dataç›®å½•çš„å†…å®¹åˆ°æ–°èŠ‚ç‚¹ã€‚
   - åˆ é™¤æ–°èŠ‚ç‚¹dataç›®å½•ä¸­çš„
     - keystoreç›®å½•ä¸‹é¢çš„è´¦å·æ•°æ®
     - åˆ é™¤gethä¸‹é¢çš„nodekeyå’Œnodeså­ç›®å½•
   - å¯åŠ¨æ–°èŠ‚ç‚¹ï¼Œæ–°èŠ‚ç‚¹æ­£å¸¸åŠ å…¥é›†ç¾¤ï¼Œå¹¶æ¢å¤åˆ°å¤‡ä»½èŠ‚ç‚¹å½“æ—¶çš„æ•°æ®çŠ¶æ€ï¼ŒåŸæœ‰èŠ‚ç‚¹æ²¡æœ‰å½±å“ï¼Œæ–°èŠ‚ç‚¹ç”Ÿæˆæ–°çš„èŠ‚ç‚¹IDï¼Œå·¥ä½œæ­£å¸¸ã€‚

2. éªŒè¯ç»“æœï¼š

   ```shell
   â€‹```shell
      # 1ã€åˆå§‹åŒ–bootnode
      geth --datadir data --networkid 20180412 init ../genesis.json
      # 2ã€å¯åŠ¨å„ä¸ªèŠ‚ç‚¹ï¼Œä¹‹å‰éœ€è¦æŠŠbootnodeçš„dataç›®å½•æ‹·è´åˆ°å„ä¸ªèŠ‚ç‚¹
      geth --datadir ./data --networkid 20180412 --bootnodes=enode://322de50135b1542f17585e73aea7ffe9585e9d988cecdff40732842113e5cdb9ae249ca3b12fe7658101632bfc5e19493acf941d9a52a2a9f16627318f01e76d@10.20.1.13:30301 --port 30303 console

      # å„èŠ‚ç‚¹ä¸Šåˆ›å»ºè´¦æˆ·ï¼ŒæŒ–çŸ¿åæŸ¥çœ‹è´¦æˆ·ä½™é¢
      personal.newAccount('123456')
      web3.fromWei(eth.getBalance(eth.accounts[0]), "ether")

      # è½¬è´¦äº¤æ˜“
      var tx = {from: "0x836eabd0b0f75c20b0e66aa57212241bfdbad467", to: "0xc9d71a928be51835335edf11a56e176b92ff5ade", value: web3.toWei(100, "ether")}
      personal.sendTransaction(tx, "123456")

      # æŒ–çŸ¿
      miner.start(1)
      miner.stop()
   ```

    æ³¨æ„ï¼š éªŒè¯å‰éœ€è¦æŠŠå„ä¸ªèŠ‚ç‚¹ä¸Šçš„dataçš„ç›®å½•åˆ é™¤æ‰ï¼Œå¯ä»¥ä¿ç•™boot.keyã€‚

3. éªŒè¯ç»“æœï¼š

   - bootnodeçš„IDæ²¡æœ‰å˜åŒ–ï¼›
   - å„ä¸ªèŠ‚ç‚¹çš„IDå˜åŒ–äº†ï¼›
   - èƒ½å¤Ÿäº’ç›¸å‘ç°ï¼›
   - è½¬è´¦äº¤æ˜“æ­£å¸¸ã€‚



## éªŒè¯æµ‹è¯•ï¼ˆä¸‰ï¼‰ï¼š æ‹·è´æ­£å¸¸èŠ‚ç‚¹çš„dataç›®å½•ï¼Œæ„å»ºæ–°èŠ‚ç‚¹

1. éªŒè¯æ€è·¯ï¼š

   - ä¸‰ä¸ªèŠ‚ç‚¹è¿è¡Œæ­£å¸¸çš„çŠ¶æ€ï¼Œåœæ‰å…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ‹·è´dataç›®å½•çš„å†…å®¹åˆ°æ–°èŠ‚ç‚¹ã€‚
   - åˆ é™¤æ–°èŠ‚ç‚¹dataç›®å½•ä¸­çš„
     - keystoreç›®å½•ä¸‹é¢çš„è´¦å·æ•°æ®
     - åˆ é™¤gethä¸‹é¢çš„nodekeyå’Œnodeså­ç›®å½•
   - å¯åŠ¨æ–°èŠ‚ç‚¹ï¼Œæ–°èŠ‚ç‚¹æ­£å¸¸åŠ å…¥é›†ç¾¤ï¼Œå¹¶æ¢å¤åˆ°å¤‡ä»½èŠ‚ç‚¹å½“æ—¶çš„æ•°æ®çŠ¶æ€ï¼ŒåŸæœ‰èŠ‚ç‚¹æ²¡æœ‰å½±å“ï¼Œæ–°èŠ‚ç‚¹ç”Ÿæˆæ–°çš„èŠ‚ç‚¹IDï¼Œå·¥ä½œæ­£å¸¸ã€‚

2. éªŒè¯ç»“æœï¼š

   - æ­£å¸¸ã€‚

   - å¦å¤–ï¼Œæ–°èŠ‚ç‚¹æ­£å¸¸å·¥ä½œæŒ–çŸ¿åï¼Œå¤‡ä»½dataç›®å½•ååˆ é™¤ï¼Œç„¶åæ¢å¤åˆ°ä¹‹å‰æ‹·è´çš„dataç›®å½•çŠ¶æ€ï¼Œé‡æ–°å†åˆ é™¤keystoreã€nodekeyå’Œnodesç­‰ï¼Œåœ¨å¯åŠ¨ä¸€ä¸ªæ–°èŠ‚ç‚¹åï¼Œä¼šè‡ªåŠ¨åŒæ­¥åˆ°æœ€æ–°çš„blockçŠ¶æ€ï¼Œå…¶ä»–å·¥ä½œä¹Ÿæ­£å¸¸ã€‚

   - æ–°æ¢å¤éƒ¨ç½²çš„èŠ‚ç‚¹ï¼Œä¸åˆ é™¤keystoreï¼ˆä¿ç•™ç›¸åŒçš„è´¦å·ï¼‰ï¼Œåªåˆ é™¤nodekeyå’Œnodesï¼Œä½œä¸ºæ–°èŠ‚ç‚¹å¯åŠ¨ï¼Œè¿™æ ·ä¸¤ä¸ªèŠ‚ç‚¹ä½¿ç”¨ç›¸åŒçš„è´¦å·ï¼ŒåŒæ—¶å¼€å§‹æŒ–çŸ¿ï¼Œæ²¡æœ‰é—®é¢˜ã€‚ï¼ˆIt is safe to transfer the entire directory or the individual keys therein between ethereum nodes. Note that in case you are adding keys to your node from a different node, the order of accounts may change.ï¼‰

   - åœ¨genesis.jsonæŒ‡å®šèµ‹å€¼çš„è´¦å·ï¼Œéšæ—¶å¯¼å…¥ï¼Œéšæ—¶å°±èƒ½çœ‹åˆ°è¿™äº›è´¦å·çš„ä½™é¢ï¼Œä¸ç”¨é¢„å…ˆå¯¼å…¥ï¼›ä¹Ÿä¸å­˜åœ¨åˆå§‹åŒ–å¤šæ¬¡çš„é—®é¢˜ï¼Œè¿™éƒ¨åˆ†åº”è¯¥æ˜¯åœ¨ç³»ç»Ÿæ¡†æ¶å±‚é¢è§£å†³çš„ã€‚

   - è®¾ç½®æŒ–çŸ¿æ”¶ç›Šè´¦å·æœªä¸åœ¨æœ¬åœ°çš„è´¦å·ï¼Œå¯ä»¥æ­£å¸¸æŒ–çŸ¿å¹¶äº§ç”Ÿæ”¶ç›Šã€‚

     â€‹

## éªŒè¯æµ‹è¯•ï¼ˆå››ï¼‰ï¼š bootnodeä¸è¿›è¡Œåˆå§‹åŒ–ï¼ŒnodeèŠ‚ç‚¹åˆ†åˆ«åˆå§‹åŒ–ï¼Œæ˜¯å¦æ­£å¸¸ï¼Ÿ

1. éªŒè¯ç»“æœï¼š

   - bootnodeèŠ‚ç‚¹ä¸éœ€è¦init dataç›®å½•ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œï¼ˆä»¥å‰éªŒè¯å¯èƒ½æ˜¯å…¶ä»–é—®é¢˜ä¸æ­£å¸¸å§ï¼‰ã€‚

     â€‹

## ç»“è®ºï¼š

1. ä½¿ç”¨`genesis.json`åˆå§‹åŒ–bootnodeæ˜¯ä¸å¿…è¦çš„ï¼›
2. ä½¿ç”¨`genesis.json`åˆå§‹åŒ–ç”Ÿæˆdataæ•°æ®æ˜¯å¿…è¦çš„ï¼Œå¯ä»¥ä½œä¸ºèŠ‚ç‚¹è¿è¡Œçš„åŸºç¡€ï¼›
3. èŠ‚ç‚¹è¿è¡Œä¹‹åä¼šç”Ÿæˆnodekeyå’Œnodeè¿è¡Œæ–‡ä»¶ï¼›
4. æ‹·è´ä¸€ä¸ªèŠ‚ç‚¹çš„dataç›®å½•ï¼Œåˆ é™¤å…¶ä¸­çš„nodekeyå’Œnodeè¿è¡Œç›®å½•ï¼Œå¯åŠ¨å‘½ä»¤å³å¯æ–°å¯åŠ¨ä¸€ä¸ªèŠ‚ç‚¹ï¼›
5. åœ¨`genesis.json`åˆå§‹åŒ–çš„è´¦å·ï¼Œæœ‰æ­£å¸¸çš„å€¼ï¼Œå¯ä»¥ä½œä¸ºèŠ‚ç‚¹çš„miner.setEtherbaseï¼Œè¿›è¡ŒæŒ–çŸ¿ï¼›
6. åªæœ‰å­˜åœ¨Keyçš„èŠ‚ç‚¹ï¼Œ æ‰èƒ½å¯¹è´¦å·è¿›è¡Œæ¶ˆè´¹æ“ä½œï¼ˆå¦åˆ™ä¼šæŠ¥å‘Šunknown accounté”™è¯¯ï¼‰ã€‚
7. åªè¦æŠŠå…¶ä»–èŠ‚ç‚¹æœ‰è¿™ä¸ªè´¦å·çš„keystoreä¸­çš„å¯¹åº”çš„keyæ‹·è´åˆ°æœ¬èŠ‚ç‚¹keystoreç›®å½•ä¸‹é¢ï¼Œå³å¯ç«‹å³ç”Ÿæ•ˆï¼Œå¯ä»¥æ¶ˆè´¹äº¤æ˜“ï¼ˆæ‹·è´è¿‡ç¨‹èŠ‚ç‚¹ä¸ç”¨åœæ­¢ï¼Œä½†æ˜¯å¯èƒ½ä¼šå½±å“èŠ‚ç‚¹å„ä¸ªè´¦å·çš„indexé¡ºåºï¼‰ã€‚

